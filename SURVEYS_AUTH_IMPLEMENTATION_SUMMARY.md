# –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –¥–ª—è –æ–ø–∏—Ç—É–≤–∞–Ω—å

## üéØ –ó–∞–≤–¥–∞–Ω–Ω—è
1. **–û–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø** –¥–æ –æ–ø–∏—Ç—É–≤–∞–Ω—å —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—ñ–¥—Å—Ç–∞–≤–ª—è—Ç–∏ —ñ–º'—è** –∑ –ø—Ä–æ—Ñ—ñ–ª—é –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ñ –ø–æ–ª—è
3. **–ó–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ** –∑ –ø—Ä–∏–≤'—è–∑–∫–æ—é –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

## ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

### 1. Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

#### –û–Ω–æ–≤–ª–µ–Ω–æ SurveyController:
```php
public function __construct()
{
    $this->middleware('auth')->except(['index']);
}
```

**–õ–æ–≥—ñ–∫–∞ –¥–æ—Å—Ç—É–ø—É:**
- **–°–ø–∏—Å–æ–∫ –æ–ø–∏—Ç—É–≤–∞–Ω—å** (`/surveys`) - –¥–æ—Å—Ç—É–ø–Ω–∏–π –≤—Å—ñ–º (–∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –ø—Ä–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é)
- **–î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞** (`/surveys/{id}`) - —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö
- **–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π** (`/surveys/{id}/submit`) - —Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

#### –õ–æ–≥—ñ–∫–∞ –≤ surveys/show.blade.php:
```php
@case('text')
    @php
        $defaultValue = '';
        // –Ø–∫—â–æ –ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ —ñ–º'—è, –ø—ñ–¥—Å—Ç–∞–≤–ª—è—î–º–æ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        if (stripos($question['question'], '—ñ–º\'—è') !== false || 
            stripos($question['question'], '–∏–º—è') !== false ||
            stripos($question['question'], 'name') !== false) {
            $defaultValue = auth()->user()->name ?? '';
        }
    @endphp
    <input type="text" 
           name="answers[{{ $index }}]" 
           class="form-input"
           value="{{ $defaultValue }}"
           {{ ($question['required'] ?? false) ? 'required' : '' }}>
@break
```

**–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏ –ø–∏—Ç–∞–Ω—å:**
- "–í–∞—à–µ —ñ–º'—è"
- "–í–∞—à–µ –∏–º—è" 
- "Your name"
- –ë—É–¥—å-—è–∫—ñ –≤–∞—Ä—ñ–∞—Ü—ñ—ó –∑ —Ü–∏–º–∏ —Å–ª–æ–≤–∞–º–∏

### 3. –û–Ω–æ–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å SurveyResponse

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ñ:
```php
protected $fillable = [
    'survey_id',    // ID –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è
    'user_id',      // ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    'answers',      // JSON –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—è–º–∏
    'ip_address',   // IP –∞–¥—Ä–µ—Å–∞
    'user_agent',   // User Agent –±—Ä–∞—É–∑–µ—Ä–∞
];

protected $casts = [
    'answers' => 'array',
];
```

#### Relationships:
```php
public function survey()
{
    return $this->belongsTo(Survey::class);
}

public function user()
{
    return $this->belongsTo(User::class);
}
```

### 4. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—î—é

#### –û–Ω–æ–≤–ª–µ–Ω–æ submit –º–µ—Ç–æ–¥:
```php
public function submit(Request $request, $id)
{
    $survey = Survey::available()->findOrFail($id);
    
    // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
    $rules = [];
    foreach ($survey->questions as $index => $question) {
        if ($question['required'] ?? false) {
            $rules["answers.{$index}"] = 'required';
        }
    }
    
    $request->validate($rules);
    
    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ user_id
    SurveyResponse::create([
        'survey_id' => $survey->id,
        'answers' => $request->answers,
        'user_id' => auth()->id(),        // ‚Üê –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
        'ip_address' => $request->ip(),
        'user_agent' => $request->userAgent(),
    ]);
    
    return view('surveys.thank-you', compact('survey'));
}
```

### 5. UI –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö/–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤

#### –°–ø–∏—Å–æ–∫ –æ–ø–∏—Ç—É–≤–∞–Ω—å (surveys/index.blade.php):

**–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö:**
```html
@auth
    <div class="auth-info">
        <span class="user-greeting">üëã –í—ñ—Ç–∞—î–º–æ, {{ auth()->user()->name }}!</span>
    </div>
@endauth
```

**–î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö:**
```html
@else
    <div class="auth-required">
        <div class="auth-message">
            üîê –î–ª—è —É—á–∞—Å—Ç—ñ –≤ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ <a href="{{ route('login') }}">—É–≤—ñ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É</a>
        </div>
    </div>
@endauth
```

#### –ö–Ω–æ–ø–∫–∏ –≤ –∫–∞—Ä—Ç–∫–∞—Ö –æ–ø–∏—Ç—É–≤–∞–Ω—å:

**–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö:**
```html
@auth
    @if($survey->is_available)
        <a href="{{ route('surveys.show', $survey->id) }}" class="btn btn-primary">
            –ü—Ä–æ–π—Ç–∏ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è
        </a>
    @else
        <button class="btn btn-disabled" disabled>
            –ù–µ–¥–æ—Å—Ç—É–ø–Ω–µ
        </button>
    @endif
@endauth
```

**–î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö:**
```html
@else
    <a href="{{ route('login') }}" class="btn btn-auth">
        üîê –£–≤—ñ–π—Ç–∏ –¥–ª—è —É—á–∞—Å—Ç—ñ
    </a>
@endauth
```

### 6. –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è

#### –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
```html
<div class="auth-user-info">
    üë§ <span class="user-name">{{ auth()->user()->name }}</span>
</div>
```

#### CSS —Å—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è:
```css
.auth-user-info {
    background: rgba(255, 255, 255, 0.15);
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    margin-bottom: 1.5rem;
    display: inline-block;
}

.user-greeting {
    background: rgba(40, 167, 69, 0.1);
    color: #28a745;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-weight: 500;
    display: inline-block;
}

.auth-message {
    background: rgba(255, 193, 7, 0.1);
    color: #856404;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    border-left: 4px solid #ffc107;
    font-weight: 500;
}

.btn-auth {
    background: #007bff;
    color: white;
}
```

### 7. –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ

#### –°—Ç–≤–æ—Ä–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
- **–Ü–º'—è**: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ
- **Email**: ivan.petrenko@student.uzhnu.edu.ua
- **–ü–∞—Ä–æ–ª—å**: password123

#### –¢–µ—Å—Ç–æ–≤–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è:
```json
{
    "survey_id": 1,
    "user_id": 1,
    "answers": [
        "5",
        ["–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è", "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"],
        "–î—É–∂–µ –≥–∞—Ä–Ω–∏–π –∫–æ–ª–µ–¥–∂, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –≤—Å—ñ–º!"
    ],
    "ip_address": "127.0.0.1",
    "user_agent": "Test Browser"
}
```

### 8. –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è

#### Middleware –∑–∞—Ö–∏—Å—Ç:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ `/login` –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è intended URL –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø—ñ—Å–ª—è –ª–æ–≥—ñ–Ω—É

#### –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö:
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –ø–æ–ª—ñ–≤
- CSRF –∑–∞—Ö–∏—Å—Ç –¥–ª—è –≤—Å—ñ—Ö —Ñ–æ—Ä–º
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è —ñ—Å–Ω—É–≤–∞–Ω–Ω—è –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

#### –ü—Ä–∏–≤–∞—Ç–Ω—ñ—Å—Ç—å:
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è user_id –¥–ª—è –Ω–µ–∞–Ω–æ–Ω—ñ–º–Ω–∏—Ö –æ–ø–∏—Ç—É–≤–∞–Ω—å
- IP –∞–¥—Ä–µ—Å–∞ —Ç–∞ User Agent –¥–ª—è –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∞–Ω–æ–Ω—ñ–º–Ω–∏—Ö –æ–ø–∏—Ç—É–≤–∞–Ω—å (is_anonymous = true)

### 9. –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤

#### –ü–µ—Ä–µ–≥–ª—è–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π:
```php
// –í –º–∞–π–±—É—Ç–Ω—å–æ–º—É –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏
$responses = SurveyResponse::with(['user', 'survey'])
    ->where('survey_id', $surveyId)
    ->get();

foreach ($responses as $response) {
    echo $response->user->name . ': ';
    echo json_encode($response->answers);
}
```

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –Ω–∞ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è
- –°–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, —â–æ –ø—Ä–æ–π—à–ª–∏ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è
- –ê–Ω–∞–ª—ñ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –ø–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞—Ö

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –©–æ —Ç–µ–ø–µ—Ä –ø—Ä–∞—Ü—é—î:
- ‚úÖ **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –æ–±–æ–≤'—è–∑–∫–æ–≤–∞** –¥–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –æ–ø–∏—Ç—É–≤–∞–Ω—å
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —ñ–º–µ–Ω—ñ** –≤ —Ç–µ–∫—Å—Ç–æ–≤—ñ –ø–æ–ª—è
- ‚úÖ **–ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ user_id** –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
- ‚úÖ **–†—ñ–∑–Ω–∏–π UI** –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö/–Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏—Ö
- ‚úÖ **–ë–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è** –∑ –≤–∞–ª—ñ–¥–∞—Ü—ñ—î—é

### Workflow –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:
1. **–ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π** - –±–∞—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –ø—Ä–æ –ª–æ–≥—ñ–Ω
2. **–ö–ª—ñ–∫ –Ω–∞ "–£–≤—ñ–π—Ç–∏"** - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –ª–æ–≥—ñ–Ω—É
3. **–ü—ñ—Å–ª—è –ª–æ–≥—ñ–Ω—É** - –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –æ–ø–∏—Ç—É–≤–∞–Ω—å –∑ –ø—Ä–∏–≤—ñ—Ç–∞–Ω–Ω—è–º
4. **–ü—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è —ñ–º–µ–Ω—ñ
5. **–í—ñ–¥–ø—Ä–∞–≤–∫–∞** - –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑ –ø—Ä–∏–≤'—è–∑–∫–æ—é –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞

### URL –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
- –°–ø–∏—Å–æ–∫ –æ–ø–∏—Ç—É–≤–∞–Ω—å: `http://localhost:8000/surveys`
- –õ–æ–≥—ñ–Ω: `http://localhost:8000/login`
- –û–ø–∏—Ç—É–≤–∞–Ω–Ω—è: `http://localhost:8000/surveys/1` (–ø—ñ—Å–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó)

## ‚úÖ –°—Ç–∞—Ç—É—Å: –ü–û–í–ù–Ü–°–¢–Æ –ì–û–¢–û–í–û

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –¥–ª—è –æ–ø–∏—Ç—É–≤–∞–Ω—å —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –∑ –ø–æ–≤–Ω–∏–º —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª–æ–º! üöÄ
